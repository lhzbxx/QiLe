开发日志

2015.11.14
To be fixed:
	1. 后台管理页面添加房源部分的修改。
	2. 后台管理页面商家列表的添加。
	3. 后台管理页面房源列表的添加。
	4. 后台管理页面订单列表的添加和操作逻辑。
Work:
	1. 添加房源中的数量字段替换为是否可用和备注，商家通过备注识别不同的房间信息，通过开关进行管理房间的库存。
	2. 添加房源中的图片上传问题，由于需要授权，而这个token信息必须由后台来生成。
	3. 添加房源中的图片上传问题，现在的解决方案是每次上传的图片记录在下面，等全部保存后再进行提交，为了能够得到基本信息中的房源ID。
	4. 商家列表和房源列表由表格展示，暂不提供修改功能。
	5. 订单列表添加对状态的修改。

2015.11.15
To be fixed:
	1. 订单列表的处理，对操作逻辑的完善。
	2. 对订单状态的更新API。
	3. 优惠券的添加和使用。
	4. 入住人信息的保存，包括对用户真实姓名的保存。
Work:
	1. 入住人信息和用户真实姓名都用全新字段进行保存。
	2. 添加了优惠券的增删API。
	3. 增加了扫描进行对手机号码的优惠券增加方式。
	4. 修改了前端超链接的样式，让它在手机上显示更加好看。
	5. 对正在跳转中的提示进行修改，现在返回前一个页面不会还亮提示。
	6. 增加了layout中的修改密码的入口。
Bug:
	1. 扫二维码添加优惠券没有验证手机的正确性。
	2. 扫描二维码的URL暴露了优惠券的参数，非常危险，但是我懒得改TuT。
	3. 没有验证下单页面的所需信息。

2015.11.16
Work:
	1. 增加了一个好像没有用的Star CSS的评价样式。
	2. 对超链接的样式进行了修改，让它不那么难看了。

2015.11.17
To be fixed:
	1. 房源列表中的修改操作。
	2. 商家列表中的修改操作。
	3. 优惠券列表，优惠券也用UUID生成，这样就可以避免URL参数暴露的问题。
Work:
	1. 完成了房源列表、商家列表的修改操作。
	2. 针对前端的样式做了小部分的修改，让它更加好看了。
	3. 制作了404页面，但是并不好看QAQ。
	4. 前端修改页面的Reset函数有问题，已经修改。
	5. 添加了优惠券模板的表。
	6. 增加了对特价房这类属性的相关字段。
	7. 对样式的路径进行了修改，应该会变得更加稳定，以后目录还是全部按这种格式进行写吧。

2015.11.18
Plan:
	1. 完成订单列表的整个流程，包括对订单的确认和删除。
	2. 完成优惠券模板的后台管理。
	3. 完成房源的搜索。
	4. 后台管理的登录，要添加表，注意一个用户只能保持一种登录状态！
	5. 房源字段的bug修复。
Work:
	1. 添加一个用户信息表，专门额外存储与用户有关的信息，需要注册的时候就进行开写。
	2. 对优惠券模板列表添加了一个库存的字段。
	3. 添加了管理用户表，创建商家的时候也要更新这个表。
	4. 去除了冗余的前端的input的name标签。
	5. 优惠券模板没有做二维码的接口，因为感觉用不到，如果实在需要，可以手动生成URL在第三方网站上获取二维码。
	6. 添加了领取优惠券的手机号验证。
	7. 对领取优惠券的页面添加了优惠券的预览，修改了一个蛋疼的CSS问题。
	8. 修复了房源信息修改时的一个bug，该bug造成插入数据库失败。
	9. 解决了房源信息的显示图片和整体图片列表的一个逻辑问题，方法是复写一次图片array。
	10. 对房源添加了开关，如果关闭则用户搜索不到。
	11. 发现时间库存有bug，考虑到闰年的情况，少了一位。
	12. 完成了对房源的时间搜索。
	13. 每次输入用户名好像有点麻烦，还是给个Cookie吧。
	14. 增加了优惠券的使用和相关的判定，只限定一个优惠券的使用。
	15. 优惠券的使用一定要返回UUID，而不是在前端进行处理！！！
	16. 订单中的信息添加了入住人、折扣的历史状态和订单人的真实姓名的保存。
	17. 订单列表基本完成，但是订单的支付没有完成。
To be fixed:
	1. 前端时间选择的控件的时间限制问题，例如不能选择今天之前的日期。
	2. 如果没有房源，现在没有任何的提示信息，应该添加一些提示。
	3. 对时间库存的搜索没有进行详细的测试，如果有机会需要彻底测试一下。
	4. 前端的时间还是得在下单页面也进行一个时间选择，不然是有问题的，因为理论上来说别人发送一个房源的详情页面，从那里下单的话并没有选择时间。
	5. 下单的详情没有做验证。
	6. 支付之前的房源的检查没有完成。
	7. 提示信息尽量转换为微信风格。
	8. 对于网络连接超时的情况没有处理。

2015.11.19
Work:
	1. 修复了总价格的bug，竟然算错了...
	2. 修复了时间选择的bug，挺神奇的一个错误...
	3. 发现了微信的一个问题，就是超链接的href不能为空，否则就一直显示本页，醉了。
	4. 对商家管理和房源管理添加了删除功能。
	5. 选择时间的初始限定，不能比今天更早。
	6. 图片的处理，利用第三方的API来加速图片的读取速度。
	7. 前端更换了一个更好的Slider插件，更加流畅了。
	8. 修正了更改密码后没有正确跳转的问题。

2015.11.20
Work:
	1. 做了发送短信的一个接口，每次用户成功地一次操作发送短信进行通知。
	2. 做了支付的超时处理，建立一个新的schedule调度处理。
	3. 新建一个优惠券分区表，进行统计不同地区的优惠券发送情况。
	4. 订单管理列表的订单时间和下单时间修复。
	5. 增加了待处理订单列表的页面。
	6. 数据库的更新现在自动添加一些测试的数据，并且初始化必要的优惠券。
	7. 现在的订单列表显示的是已付款的订单，如果进入预定时间则显示订单进行中，并且在预定的时间结束以后显示订单已完成。
	8. 优惠券的发送接口添加了查重处理。

2015.11.21
Work:
	1. 放弃了对数据库添加计时器，因为sqlite3支持有限。
	2. 对用户的订单中心样式进行了修改，模仿了小猪短租。
	3. 对订单中心进行了字段展示。
	4. 放弃了对时间戳转换的格式修改，因为unicode字符的缘故。
	5. 对下单时的入住人和真实姓名添加了字段添加的验证处理。
	6. 现在用户可以在订单详情中对未付款且没有失效的订单进行支付。
	7. 微信支付不支持二级目录，用url参数代替pay页面ID。
	8. python的hashlib库有毒，md5倒是可以直接用。
	9. 根据地区（扫描二维码）成功获得优惠券返回微信文章页面。
	10. 添加了后台管理的登录页面。
	11. 简化订单编号。
	12. 去除了header上的border color。

2015.11.23
Work:
	1. 微信支付需要使用用户的openid，所以必须增加一个字段进行保存之。
	2. CRM商户修改的bug原因是因为初始化数据库时有一个不能被检索到的商家。
	3. 前端首页上的轮播箭头透明。
	4. 前段列表页面的筛选隐藏。
	5. 房源信息图片箭头隐藏。
	6. 后端Nginx添加了SSL 443安全端口，为了配合微信支付的安全功能。但后期可能需要购买第三方的SSL协议证书。
	7. 微信支付的用户openid的获取。

2015.11.24:
Work:
	1. 解决了微信支付的问题，原来现在微信支付的接口已经改变，统一使用JSSDK，而放弃了对内置浏览器的依赖。
	2. 我发现缓存一些熟知的话，直接使用app.config就可以了，挺方便的。
	3. 现在application文件已经太太太太太长了，准备以后写函数就写在Util里了。
	4. 对用户保存了openid，这样就不用每次对一个用户的支付请求进行授权了。
	5. 修改了前端的样式。
Bug:
	1. 微信的预支付处理的时候的价格是按照分位为起始位的。
	2.房源支付成功后的库存还没有处理。
	3. 现在已经统一下了订单再判断房源是否可用，所以需要提前在下单的时候就把房源的库存去除。
	4. 优惠券的发放似乎存在问题。

2015.11.25:
Work:
	1. 优惠券发放的判断方法有问题，必须得使用not前置的方法，这个我之前一直没有注意到。
	2. 注册的跳转没有加入next的函数，所以之前的注册都无法跳转，现在已经修复。
	3. 优惠券已经可以发送成功，不过后续需要添加模板，要不然通知短信发得太慢。
	4. 更改了前端房源详情的轮播图片的箭头透明度。
	5. 调整了datetimerangepicker的色系。
	6. 完成了支付的整体逻辑，包括在支付之前进行检测房源和优惠券的有效性。
	7. 但是有一点要注意的是，要考虑到用户最终使用优惠券以后最好价格不要为0，不然在微信的后台预支付处理会有麻烦，可能不通过。
	8. 对后台添加了一个简单的库存检查按钮，可以查看已经占用的天数（后期可以考虑在日历上显示而使其更加可视化）
	9. 微信支付依旧是测试域名和debug模式，所以还是alert语句，忽略之就好。
	10. 可以在后台进行对于房间开关，现在已经关闭了两个房间，而剩下的一个房间11-25日已经被占用，所以搜索之后为空。
Bug:
	1. 如果没有可用的房源，现在没有任何提示，不太友好，可以考虑加一个图片什么的。
	2. 微信支付后还有一个预留的接口可以向用户发送微信消息，这一块我没有做。
	3. 可以考虑再做一个小的针对微信的接口，来完善用户体验，不仅解决Bug2，还可以在自定义菜单中的订单中心进行响应。